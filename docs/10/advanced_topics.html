<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Micro Focus Content Manager SDK 10.0: Advanced Topics</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygenBase.css" rel="stylesheet" type="text/css" />
<link href="doxyStylesheet.css" rel="stylesheet" type="text/css"/>
<link href="doxySidebarFixes.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf_logo_white_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Micro Focus Content Manager SDK 10.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('advanced_topics.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Advanced Topics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#ways_To_Fetch_a_TrimMainObject">Different ways to fetch a TrimMainObject</a><ul><li class="level2"><a href="#fetch_by_constructorand_name">Object constructor by Name</a><ul><li class="level3"><a href="#autotoc_md115">Code example</a></li>
</ul>
</li>
<li class="level2"><a href="#object_name_properties">Object name properties</a></li>
<li class="level2"><a href="#fetch_by_database">Database find methods</a><ul><li class="level3"><a href="#autotoc_md116">Code samples</a></li>
</ul>
</li>
<li class="level2"><a href="#fetch_by_search">TrimMainObjectSearch</a><ul><li class="level3"><a href="#autotoc_md117">Code sample</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#fetchDoc">Document access alternatives</a><ul><li class="level2"><a href="#doc_access_overview">Overview</a></li>
<li class="level2"><a href="#getDoc">Record.GetDocument()</a><ul><li class="level3"><a href="#autotoc_md119">Checkout without getting the document</a></li>
</ul>
</li>
<li class="level2"><a href="#clientCache">DocumentPathInClientCache</a><ul><li class="level3"><a href="#autotoc_md120">Example</a></li>
</ul>
</li>
<li class="level2"><a href="#wgsCache">DocumentPathInWGSCache</a><ul><li class="level3"><a href="#autotoc_md121">Example</a></li>
</ul>
</li>
<li class="level2"><a href="#downloadNotifier">DownloadNotifier</a><ul><li class="level3"><a href="#autotoc_md122">Example</a></li>
</ul>
</li>
<li class="level2"><a href="#dowload_other_object_types">Other object types</a></li>
</ul>
</li>
<li class="level1"><a href="#localisedStrings">Localised strings</a><ul><li class="level2"><a href="#trimMEssages">TrimMessages</a><ul><li class="level3"><a href="#autotoc_md123">Code Sample</a></li>
</ul>
</li>
<li class="level2"><a href="#objectCaptions">Captions</a><ul><li class="level3"><a href="#enumCaptions">Enum captions</a></li>
<li class="level3"><a href="#propertyCaptions">Property Captions</a></li>
<li class="level3"><a href="#searchClauseCaptions">Search Clause Captions</a></li>
<li class="level3"><a href="#menuItemCaptions">Menu items</a></li>
</ul>
</li>
<li class="level2"><a href="#formDefinitionCaptions">FormDefinition</a></li>
</ul>
</li>
<li class="level1"><a href="#lookupset_Items">Fetching LookupSet Items</a><ul><li class="level2"><a href="#new_lookupitem">Example: Adding a new LookupItem</a></li>
<li class="level2"><a href="#fetching_lookup_items">Example: Fetching lookup items</a></li>
</ul>
</li>
<li class="level1"><a href="#create_record_manual_number">Create a Record using manual numbering</a><ul><li class="level2"><a href="#example_manual_record_number">Example: Manual Record Number</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_doc_90___Guides"></a></p>
<h1><a class="anchor" id="ways_To_Fetch_a_TrimMainObject"></a>
Different ways to fetch a TrimMainObject</h1>
<p>Accessing a Record is <a class="el" href="programming_guide.html#access_existing_record">discussed briefly</a> in the help but there are a variety of ways to get a <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_main_object.html">TrimMainObject</a>. </p>
<h2><a class="anchor" id="fetch_by_constructorand_name"></a>
Object constructor by Name</h2>
<p>As <a class="el" href="programming_guide.html#access_existing_record">discussed</a> in the help use the Name or Uri to instantiate the object.</p>
<h3><a class="anchor" id="autotoc_md115"></a>
Code example</h3>
<p>This example fetches a <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_classification.html">Classification</a> by name. <br  />
</p>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a5c9335b28e6277ddbe0137f04e5e58a7">Classification</a> classification = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a5c9335b28e6277ddbe0137f04e5e58a7">Classification</a>(database, <span class="stringliteral">&quot;Accommodation - Domestic - General&quot;</span>);</div>
<div class="line">Console.WriteLine(classification.Title);</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a9a91a6f03e7107a92af44bdd2092ca45a5c9335b28e6277ddbe0137f04e5e58a7"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a5c9335b28e6277ddbe0137f04e5e58a7">TRIM.SDK.AlertConditionTypes.Classification</a></div><div class="ttdeci">@ Classification</div><div class="ttdoc">For Records that have a Classification of</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="object_name_properties"></a>
Object name properties</h2>
<p>As can be seen a certain knowledge of the object type is required to fetch by name. For example, the name property for each object type is different. For most object types the name property is <code>Name</code>. Here is a list of those object types where that rule does not apply:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Object Types   </th><th class="markdownTableHeadNone">Name Property    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ActionDef   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_action_def.html#a722dfc3b25cec146f21a713a317c32d3">ActionName</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">AgendaItem   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_agenda_item.html#a0bf9759e7ccbc0291ad46ca25bd388a2">Number</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Alert   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_alert.html#a394f4b89e986a3602f1fe5690c737991">Description</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Classification   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_classification.html#a337d05371adb7ccb35e9377f55dd0851">Title</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Communication   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_communication.html#ad41e523ad8ee1b93ee1c1b33814c5493">Description</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Consignment   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_consignment.html#a831f20e86bb651ff1f231843949c6062">Number</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ConsignmentApprover   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_consignment_approver.html">Record</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ConsignmentIssue   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_consignment_issue.html#a2afa19aece5ee0bf319bae340ead416f">Record</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">History   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_history.html#aa7245277efba0f1802eadb477a3e1e36">EventDescription</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Location   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_location.html#ac25e75c8014dc39bda40a0a9372ff804">SortName</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">MinuteItem   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_minute_item.html#a766c3289f5043c05b548d61d757469be">Description</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">OfflineRecord   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_offline_record.html#a2b5bd0500363ade29105fa49e1053310">Title</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Record   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_record.html#add5d3b815db2d240489565e2ffa88ef2">Number</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RecordAction   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_record_action.html#af1263992951c7492d7c3635e56d52c1e">ActionName</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Request   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_request.html#a9606eb9318d3da57c1237582dcc6e428">Record</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SavedSearch   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_saved_search.html#a5fa3fb4434bca0e384bfe8f5bad4ae48">FullName</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ScheduledTask   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_scheduled_task.html#a29d6beefae5a32bb09522c9426c4c942">Description</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SharePointItem   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_share_point_item.html#aeb33c31fe04efbb9f966ff764aac798f">UniqueId</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Space   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_space.html#abe4a9c045f72cf961ce4593c903aac15">Number</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TodoItem   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_todo_item.html#a6736cbe1bafa64222a778d7c882cdece">Description</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">UserLabel   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_user_label.html#a19ff45f208c4df6ef6b369e0a6c12769">FullName</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ZipCode   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_zip_code.html#a261b8f4d9842780f89925d650ffef13a">Postcode</a>   </td></tr>
</table>
<p>Even with this information there are still things to be aware of, for example:</p><ul>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_location.html#ac25e75c8014dc39bda40a0a9372ff804">Location.SortName</a> is not necessarily unique. If you use it in a <code>Location</code> constructor and there is more than one match, an exception will be thrown.</li>
<li>While <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_classification.html#a337d05371adb7ccb35e9377f55dd0851">Classification.Title</a> is the name property for <code>Classification</code>, <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_classification.html#a7ab25c75c63f530bb48d0279d634dbd1">Classification.IdNumber</a> will also work.</li>
</ul>
<h2><a class="anchor" id="fetch_by_database"></a>
Database find methods</h2>
<p>There are a number of methods available on the <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_database.html">Database</a> object. They key difference between these and the object constructors is that these return null if the object cannot be found, while the object constructors throw an exception. These methods are:</p><ul>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_database.html#ae0c35a8c7b061c244a3deb94027e8ac6">Database.FindTrimObjectByName()</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_database.html#a404187bed49dc83d0883ba62728b2787">Database.FindTrimObjectByUri()</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_database.html#ae839c8a34d30efb47572c259ee57d9ff">Database.FindTrimObjectByURN()</a></li>
</ul>
<h3><a class="anchor" id="autotoc_md116"></a>
Code samples</h3>
<div class="fragment"><div class="line"><span class="comment">// fetch by Record Number</span></div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> record1 = database.FindTrimObjectByName(<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Record, <span class="stringliteral">&quot;REC_1&quot;</span>) as <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>;</div>
<div class="line">Console.WriteLine(record1.Title);</div>
<div class="line"><span class="comment">// Fetch by Uri</span></div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> record2 = database.FindTrimObjectByUri(<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Record, 9000000001) as <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>;</div>
<div class="line">Console.WriteLine(record2.Title);</div>
<div class="line"><span class="comment">// Fetch by URN</span></div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> record3 = database.FindTrimObjectByURN(<span class="stringliteral">&quot;trim:I1/rec/9000000001&quot;</span>) as <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>;</div>
<div class="line">Console.WriteLine(record3.Title);</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">TRIM.SDK.BaseObjectTypes</a></div><div class="ttdeci">BaseObjectTypes</div><div class="ttdoc">The BaseObjectTypes enum</div><div class="ttdef"><b>Definition:</b> BaseObjectTypes.cs:16</div></div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">TRIM.SDK.BaseObjectTypes.Record</a></div><div class="ttdeci">@ Record</div></div>
</div><!-- fragment --> <blockquote class="doxtable">
<p><b>Note:</b> The URN property is typically used when you need to persist a database- and object-type independent identifier for the object. </p>
</blockquote>
<h2><a class="anchor" id="fetch_by_search"></a>
TrimMainObjectSearch</h2>
<p><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html">TrimMainObjectSearch</a> may be used in place of the constructor and <code>Database</code> methods of fetching an object. One benefit when fetching by name, where the name may not be unique, is that you can respond better to the various scenarios.</p>
<h3><a class="anchor" id="autotoc_md117"></a>
Code sample</h3>
<div class="fragment"><div class="line"><span class="comment">// Find all Locations where the name starts with David</span></div>
<div class="line">TrimMainObjectSearch locationSearch = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Location);</div>
<div class="line">locationSearch.SelectByPrefix(<span class="stringliteral">&quot;david&quot;</span>);</div>
<div class="line"><span class="keywordflow">foreach</span> (Location location <span class="keywordflow">in</span> locationSearch)</div>
<div class="line">{</div>
<div class="line">    Console.WriteLine(location.FullFormattedName);</div>
<div class="line">}</div>
<div class="line"><span class="comment">// Find the Locations with the Uri 1</span></div>
<div class="line">locationSearch = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Location);</div>
<div class="line">locationSearch.SelectByUris(<span class="keyword">new</span> <span class="keywordtype">long</span>[] { 1 });</div>
<div class="line"><span class="keywordflow">foreach</span> (Location location <span class="keywordflow">in</span> locationSearch)</div>
<div class="line">{</div>
<div class="line">    Console.WriteLine(location.FullFormattedName);</div>
<div class="line">}</div>
<div class="line"><span class="comment">// Find all Locations who are direct members of the group &#39;Adelaide&#39;</span></div>
<div class="line">locationSearch = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Location);</div>
<div class="line">locationSearch.SelectThoseWithin(<span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a>(database, <span class="stringliteral">&quot;Adelaide&quot;</span>));</div>
<div class="line"><span class="keywordflow">foreach</span> (Location location <span class="keywordflow">in</span> locationSearch)</div>
<div class="line">{</div>
<div class="line">    Console.WriteLine(location.FullFormattedName);</div>
<div class="line">}</div>
<div class="line"><span class="comment">// Find all Locations where the sort name is david</span></div>
<div class="line"><span class="comment">// You may want to return an error if there is more than one result, if you are looking for a unique Location</span></div>
<div class="line">locationSearch = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Location);</div>
<div class="line">locationSearch.SetSearchString(<span class="stringliteral">&quot;locSortName:david&quot;</span>);</div>
<div class="line"><span class="keywordflow">foreach</span> (Location location <span class="keywordflow">in</span> locationSearch)</div>
<div class="line">{</div>
<div class="line">    Console.WriteLine(location.FullFormattedName);</div>
<div class="line">}</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">TRIM.SDK.BaseObjectTypes.Location</a></div><div class="ttdeci">@ Location</div></div>
</div><!-- fragment --> <hr  />
<h1><a class="anchor" id="fetchDoc"></a>
Document access alternatives</h1>
<h2><a class="anchor" id="doc_access_overview"></a>
Overview</h2>
<p>There are a variety of ways to retrieve an electronic document attached to a Record (or other object type). These are:</p><ul>
<li><a href="#getDoc">Record.GetDocument()</a></li>
<li><a href="#wgsCache">DocumentPathInClientCache</a></li>
<li><a href="#clientCache">DocumentPathInWGSCache</a></li>
<li><a href="#downloadNotifier">DownloadNotifier</a></li>
</ul>
<h2><a class="anchor" id="getDoc"></a>
Record.GetDocument()</h2>
<p><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_record.html#a3244e6444eadd9af0efb9199dedba632">Record.GetDocument()</a> is the primary way to get an electronic document from a Record and will be used for most .NET SDK applications. It allows the user to fetch a copy of the document from the document store to their local hard drive. If the document is already in the users cache then it will be retrieved from the cache, rather than from the store.</p>
<h3><a class="anchor" id="autotoc_md119"></a>
Checkout without getting the document</h3>
<p>You may wish to set the Record edit status to 'checked out', without fetching the Record. In this case simply call <code>GetDocument()</code> with a null <code>outputDocumentName</code>. For example:</p>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> record = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(database, <span class="stringliteral">&quot;REC_430&quot;</span>);</div>
<div class="line">record.GetDocument(<span class="keyword">null</span>, <span class="keyword">true</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</div>
</div><!-- fragment --> <h2><a class="anchor" id="clientCache"></a>
DocumentPathInClientCache</h2>
<p>This method of fetching documents was added to improve support for web services. The advantage it has over <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_record.html#a3244e6444eadd9af0efb9199dedba632">Record.GetDocument()</a> is that it does not require you to store a new copy of the document, copied from your local cache to the path in the <code>outputDocumentName</code> parameter. If document store caching is disabled, this property will be empty, unless your application is running as a service or web service.</p>
<h3><a class="anchor" id="autotoc_md120"></a>
Example</h3>
<div class="fragment"><div class="line">TrimApplication.SetAsWebService(<span class="stringliteral">&quot;c:\\hptrim\\mytest&quot;</span>);</div>
<div class="line"><span class="keyword">using</span> (<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a> database = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a>())</div>
<div class="line">{</div>
<div class="line">    database.Id = <span class="stringliteral">&quot;I1&quot;</span>;</div>
<div class="line">    database.WorkgroupServerName = <span class="stringliteral">&quot;local&quot;</span>;</div>
<div class="line">    database.TrustedUser = <span class="stringliteral">&quot;itu_tenduser&quot;</span>;</div>
<div class="line">    database.Connect();</div>
<div class="line">    <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> record = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(database, <span class="stringliteral">&quot;REC_430&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (!record.IsDocumentInClientCache)</div>
<div class="line">    {</div>
<div class="line">        record.LoadDocumentIntoClientCache();</div>
<div class="line">    }</div>
<div class="line">    Console.WriteLine(record.DocumentPathInClientCache);</div>
<div class="line">}</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">TRIM.SDK.BaseObjectTypes.Database</a></div><div class="ttdeci">@ Database</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="wgsCache"></a>
DocumentPathInWGSCache</h2>
<p>If your workgroup server has document caching enabled, an application running on that server (not on a client machine) can use the <code>DocumentPathInWgsCache</code> property to get the location of the document in the workgroup server cache. The benefit of doing so is that the workgroup server cache can be pre-emptively loaded, so that the document can be present in the cache before it is first asked for.</p>
<h3><a class="anchor" id="autotoc_md121"></a>
Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> record = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(database, <span class="stringliteral">&quot;REC_430&quot;</span>);</div>
<div class="line">Console.WriteLine(record.DocumentPathInWGSCache);</div>
</div><!-- fragment --> <h2><a class="anchor" id="downloadNotifier"></a>
DownloadNotifier</h2>
<p><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_download_notifier.html">DownloadNotifier</a> implements a download mechanism with two advantages over other document access methods:</p><ol type="1">
<li>it starts returning bytes almost immediately, rather than you having to wait until the entire file has been copied from the document store, and</li>
<li>you may start part way through a file.</li>
</ol>
<p><code>DownloadNotifier</code> is of particular use in web applications, where you will want to start returning the file to the end user as soon as possible, rather than waiting until the entire file has been fetched from the document store, and also where you may wish to have a resumable download.</p>
<h3><a class="anchor" id="autotoc_md122"></a>
Example</h3>
<div class="fragment"><div class="line"><span class="keywordtype">long</span> count = 20922;</div>
<div class="line"><span class="keywordtype">byte</span>[] buffer = <span class="keyword">new</span> <span class="keywordtype">byte</span>[20922];</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> record = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(database, <span class="stringliteral">&quot;REC_43&quot;</span>);</div>
<div class="line"><span class="keywordtype">long</span> bytesSoFar = 0; <span class="comment">// use bytesSoFar to start part way through the file for a partial download</span></div>
<div class="line"><span class="keyword">using</span> (DownloadNotifier notifier = <span class="keyword">new</span> DownloadNotifier(database, count, bytesSoFar))</div>
<div class="line">{</div>
<div class="line">    notifier.OnChunkAvailable += (<span class="keywordtype">byte</span>[] chunk, <span class="keywordtype">long</span> chunkPos, <span class="keywordtype">long</span> chunkLen, <span class="keywordtype">bool</span> lastChunk) =&gt;</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Write the chunk to an output stream here.</span></div>
<div class="line">    };</div>
<div class="line">    <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#af0248449b695ed5eb8ee4ff76d36eff6aeaaefa2eb0b058d0642a985316176535">ExtractDocument</a> extractDoc = record.GetExtractDocument();</div>
<div class="line">    extractDoc.DoExtract(<span class="keyword">null</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">null</span>);</div>
<div class="line">}</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_af0248449b695ed5eb8ee4ff76d36eff6aeaaefa2eb0b058d0642a985316176535"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#af0248449b695ed5eb8ee4ff76d36eff6aeaaefa2eb0b058d0642a985316176535">TRIM.SDK.OutputPathTypes.ExtractDocument</a></div><div class="ttdeci">@ ExtractDocument</div><div class="ttdoc">For Document Extraction</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="dowload_other_object_types"></a>
Other object types</h2>
<p>While this document has focused primarily on Records other <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_main_object.html">main</a> and <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_child_object.html">child</a> objects also implement <a class="el" href="interface_t_r_i_m_1_1_s_d_k_1_1_i_trim_document.html">ITrimDocument</a>, and therefore also support electronic documents. These objects will at least support the <a class="el" href="interface_t_r_i_m_1_1_s_d_k_1_1_i_trim_document.html#a162902ca06d3eade4a625f91efa3d995">Client Cache</a> method of getting the document, and may also implement a method returning an <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_extract_document.html">ExtractDocument</a> (such as <a href="TRIM.SDK.LocationEAddress.GetExtractDocument">LocationEAddress</a> )</p>
<h1><a class="anchor" id="localisedStrings"></a>
Localised strings</h1>
<p>When building a user interface based on the Content Manager SDK, it can be helpful to use the captioned and localised strings provided by Content Manager. Most strings used by Content Manager are available from the SDK in a way that will account for the user's language choice and changes to captions.</p>
<h2><a class="anchor" id="trimMEssages"></a>
TrimMessages</h2>
<p><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_application_base.html#aee4017d46ad0d676f9e3b171a88a137a">TrimApplication.GetMessage()</a> is used to fetch error and other messages from Content Manager. These messages will automatically account for any custom captions.</p>
<h3><a class="anchor" id="autotoc_md123"></a>
Code Sample</h3>
<div class="fragment"><div class="line"><span class="comment">//This code will display the following string, replacing the word &#39;record&#39; with the custom caption for &#39;record&#39; if set.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// This record has  alternate contents. You can use the Show Alternate Contents button if you wish to load these relationships.</span></div>
<div class="line"><span class="keywordtype">string</span> message = TrimApplication.GetMessage(database, MessageIds.bob_recHasAltContentsMsg);</div>
<div class="line">Console.WriteLine(message);</div>
</div><!-- fragment --> <h2><a class="anchor" id="objectCaptions"></a>
Captions</h2>
<p>Many custom strings can be fetched from an objects <code>Caption</code> property. This is particularly important when captions have been customised.</p>
<h3><a class="anchor" id="enumCaptions"></a>
Enum captions</h3>
<p>This code displays the caption (and plural caption) of the <code>DisposalType</code> enum followed by the captions for each <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_enum_item.html">EnumItem</a>. <br  />
</p>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m.html">TRIM</a>.<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html">SDK</a>.<a class="code" href="class_t_r_i_m_1_1_s_d_k_1_1_enum.html">Enum</a> myEnum = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m.html">TRIM</a>.<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html">SDK</a>.<a class="code" href="class_t_r_i_m_1_1_s_d_k_1_1_enum.html">Enum</a>(<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a8365d4848a1d591c9d414bdcdf180d3f">AllEnumerations</a>.DisposalType, database);</div>
<div class="line">Console.WriteLine(myEnum.Caption);</div>
<div class="line">Console.WriteLine(myEnum.CaptionPlural);</div>
<div class="line"><span class="keywordflow">foreach</span> (EnumItem enumItem <span class="keywordflow">in</span> myEnum.GetItemArray(<span class="keyword">null</span>, <span class="keyword">true</span>))</div>
<div class="line">{</div>
<div class="line">    Console.WriteLine(enumItem.Caption);</div>
<div class="line">}</div>
<div class="ttc" id="aclass_t_r_i_m_1_1_s_d_k_1_1_enum_html"><div class="ttname"><a href="class_t_r_i_m_1_1_s_d_k_1_1_enum.html">TRIM.SDK.Enum</a></div><div class="ttdoc">A helper class that allows you to iterate through enum item values and access captions for them.</div><div class="ttdef"><b>Definition:</b> Enum.cs:16</div></div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html">TRIM.SDK</a></div><div class="ttdef"><b>Definition:</b> ApiHost.cs:5</div></div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a8365d4848a1d591c9d414bdcdf180d3f"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a8365d4848a1d591c9d414bdcdf180d3f">TRIM.SDK.AllEnumerations</a></div><div class="ttdeci">AllEnumerations</div><div class="ttdef"><b>Definition:</b> AllEnumerations.cs:13</div></div>
<div class="ttc" id="anamespace_t_r_i_m_html"><div class="ttname"><a href="namespace_t_r_i_m.html">TRIM</a></div><div class="ttdef"><b>Definition:</b> ApiHost.cs:5</div></div>
</div><!-- fragment --> <h3><a class="anchor" id="propertyCaptions"></a>
Property Captions</h3>
<p>The <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_property_def.html">PropertyDef</a> class supplies captions for object properties. Use the code below to get all writable property captions for the <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_location.html">Location</a> object. Other static methods to get <code>PropertyDef</code> objects are:</p><ul>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_property_def.html#a4d041ff35fe7335dad3ebaf8bdabd735">PropertyDef.GetAllProperties()</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_property_def.html#a1b2b479c7059fc8e28f9f51be41f7c4b">PropertyDef.GetDataGridProperties()</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_property_def.html#a336c65f117101f4a3c7ae2d2f11be714">PropertyDef.GetViewPaneProperties()</a></li>
</ul>
<div class="fragment"><div class="line"><span class="keywordflow">foreach</span> (PropertyDef propertyDef <span class="keywordflow">in</span> PropertyDef.GetWriteableProperties(<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Location, database))</div>
<div class="line">{</div>
<div class="line">    Console.WriteLine(propertyDef.Caption);</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="searchClauseCaptions"></a>
Search Clause Captions</h3>
<p>Search clause captions work similarly to property definitions except that you must get a list of <a href="ref @TRIM.SDK.SearchClauseIds">SearchClauseIds</a>, and then construct a <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_search_clause_def.html">SearchClauseDef</a> from the <code>SearchClauseId</code>. The sample below writes the captions for all <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_activity.html">Activity</a> search clauses.</p>
<div class="fragment"><div class="line"><span class="keywordflow">foreach</span> (SearchClauseIds clauseId <span class="keywordflow">in</span> SearchClauseDef.GetAllSearchClauseIds(<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Activity, database))</div>
<div class="line">{</div>
<div class="line">    SearchClauseDef clauseDef = <span class="keyword">new</span> SearchClauseDef(clauseId, database);</div>
<div class="line">    Console.WriteLine(clauseDef.Caption);</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="menuItemCaptions"></a>
Menu items</h3>
<p>Menus in Content Manager are available for inspection as well. Once again a definition object, <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_command_def.html">CommandDef</a>, provides metadata such as the menu or status bar string for each menu item.</p>
<div class="fragment"><div class="line">MenuPopup menuPopup = MenuPopup.GetMenuForTrimObject(database, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Classification);</div>
<div class="line"><span class="keywordflow">foreach</span> (var menuItem <span class="keywordflow">in</span> menuPopup)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (menuItem is CommandDef)</div>
<div class="line">    {</div>
<div class="line">        CommandDef cdef = menuItem as CommandDef;</div>
<div class="line">        Console.WriteLine(cdef.GetMenuEntryString(<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Classification));</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="formDefinitionCaptions"></a>
FormDefinition</h2>
<p><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_form_definition.html">FormDefiniton</a> is particularly useful for Records where it is possible to set custom captions on the various properties on the Record entry form. As with the other definition objects, <code>FormDefinition</code> (and its related classes) are useful for much more than captions, and in fact they are the foundation from which the Content Manager Web Client forms are built.</p>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> recordType = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(database, <span class="stringliteral">&quot;Document&quot;</span>);</div>
<div class="line">FormDefinition formDefinition = recordType.RecordPropertiesFormDefinition;</div>
<div class="line"><span class="keywordflow">for</span> (uint pageCount = 0; pageCount &lt; formDefinition.PageCount; pageCount++)</div>
<div class="line">{</div>
<div class="line">    PageDefinition pageDefinition = formDefinition.GetPage(pageCount);</div>
<div class="line">    Console.WriteLine(pageDefinition.Caption);</div>
<div class="line">    <span class="keywordflow">for</span> (uint itemCount = 0; itemCount &lt; pageDefinition.ItemCount; itemCount++)</div>
<div class="line">    {</div>
<div class="line">        PageItemDefinition itemDefinition = pageDefinition.GetItem(itemCount);</div>
<div class="line">        Console.WriteLine(itemDefinition.Caption);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">TRIM.SDK.AlertConditionTypes.RecordType</a></div><div class="ttdeci">@ RecordType</div><div class="ttdoc">For Records that have a Record Type of</div></div>
</div><!-- fragment --> <h1><a class="anchor" id="lookupset_Items"></a>
Fetching LookupSet Items</h1>
<p>In Content Manager 8.2, <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_lookup_set.html">LookupSet</a> items were freed from the restrictions of being of type <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_child_object.html">TrimChildObject</a>. This means that a lookup set item (<a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_lookup_item.html">LookupItem</a>) is now a <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_main_object.html">TrimMainObject</a>, at the same level as the lookup set itself. Why was this done? Mainly to allow for large lookup sets. The parent/child relationship among Content Manager objects imposes practical limits on the number of children a main object can have.</p>
<h2><a class="anchor" id="new_lookupitem"></a>
Example: Adding a new LookupItem</h2>
<p>To add a new <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_lookup_item.html">LookupItem</a>, instantiate it using the <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_lookup_set.html">LookupSet</a> as the constructor parameter.</p>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a91dba629c9e6f4039af8cebac763478d">LookupSet</a> lookupSet = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a91dba629c9e6f4039af8cebac763478d">LookupSet</a>(database, 9000000000);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a8f19a58561f3fda03f457894923c5c49">LookupItem</a> lookupItem = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a8f19a58561f3fda03f457894923c5c49">LookupItem</a>(lookupSet);</div>
<div class="line">lookupItem.Name = <span class="stringliteral">&quot;My Test&quot;</span>;</div>
<div class="line">lookupItem.Save();</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650a8f19a58561f3fda03f457894923c5c49"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a8f19a58561f3fda03f457894923c5c49">TRIM.SDK.BaseObjectTypes.LookupItem</a></div><div class="ttdeci">@ LookupItem</div></div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650a91dba629c9e6f4039af8cebac763478d"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a91dba629c9e6f4039af8cebac763478d">TRIM.SDK.BaseObjectTypes.LookupSet</a></div><div class="ttdeci">@ LookupSet</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="fetching_lookup_items"></a>
Example: Fetching lookup items</h2>
<p>You can get a list of lookup items, just as you would any other main object type (e.g. record or location), using <code>TrimMainObjectSearch</code>, as seen here.</p>
<div class="fragment"><div class="line">TrimMainObjectSearch lookupItemSearch = <span class="keyword">new</span> TrimMainObjectSearch(database, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.LookupItem);</div>
<div class="line">lookupItemSearch.SetSearchString(<span class="stringliteral">&quot;set:9000000000&quot;</span>);</div>
<div class="line"><span class="keywordflow">foreach</span> (LookupItem item <span class="keywordflow">in</span> lookupItemSearch)</div>
<div class="line">{</div>
<div class="line">    Console.WriteLine(item.Name);</div>
<div class="line">}</div>
</div><!-- fragment --> <h1><a class="anchor" id="create_record_manual_number"></a>
Create a Record using manual numbering</h1>
<p>When a Record Type has a Record Number containing both manual and automatic portions, user interaction is required to create the Record. This can be done in the SDK by first suggesting a number (to get the auto-generated portion), and then replacing the manual portion with input from the user.</p>
<p><img src="record_manual_number.PNG" alt="" class="inline" title="Record Number"/></p>
<h2><a class="anchor" id="example_manual_record_number"></a>
Example: Manual Record Number</h2>
<div class="fragment"><div class="line"><span class="keywordtype">string</span> manualPortion = <span class="stringliteral">&quot;TRY-THIS&quot;</span>;</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> rt = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(database, <span class="stringliteral">&quot;RECORD TYPE NAME&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> rec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(rt);</div>
<div class="line">rec.Title = <span class="stringliteral">&quot;test&quot;</span>;</div>
<div class="line"><span class="keywordtype">string</span> suggestedNumber = rec.GetSuggestedNumber(<span class="keyword">true</span>);</div>
<div class="line">suggestedNumber = suggestedNumber.Replace(<span class="stringliteral">&quot;zzz-aaaa&quot;</span>, manualPortion);</div>
<div class="line">rec.LongNumber = suggestedNumber;</div>
<div class="line">rec.Save();</div>
</div><!-- fragment --></div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
